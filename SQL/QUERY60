SELECT C.CNUM, C.CNAME
FROM CUST C
WHERE C.RATING = (
    SELECT MAX(C1.RATING)
    FROM CUST C1
    WHERE C1.CITY = C.CITY
);
